@model PhoneStore_New.Models.ViewModels.ChangePasswordViewModel
@{
    ViewBag.Title = "Đổi mật khẩu";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    /* CSS Riêng cho trang Profile/ChangePass */
    .profile-wrapper {
        margin-top: 30px;
        margin-bottom: 60px;
    }

    /* Menu bên trái */
    .list-group-item {
        border-radius: 0;
        border-left: 3px solid transparent;
        transition: 0.2s;
        color: #555;
    }

        .list-group-item:hover {
            background-color: #f9f9f9;
            color: #333;
        }

        .list-group-item.active {
            background-color: #fff;
            color: #d0011b; /* Màu đỏ chủ đạo */
            border-color: #ddd;
            border-left: 3px solid #d0011b;
            font-weight: bold;
        }

    .list-group-item-danger {
        color: #d9534f;
    }

        .list-group-item-danger:hover {
            background-color: #f2dede;
            color: #a94442;
        }

    /* Form bên phải */
    .profile-content {
        background: #fff;
        border: 1px solid #e1e1e1;
        border-radius: 4px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.03);
    }

    .profile-header {
        padding: 15px 20px;
        border-bottom: 1px solid #eee;
        background: #fcfcfc;
    }

        .profile-header h3 {
            margin: 0;
            font-size: 18px;
            text-transform: uppercase;
            color: #333;
            font-weight: 700;
        }

    .profile-body {
        padding: 30px;
    }

    /* Input & Button */
    .form-control {
        height: 40px;
        box-shadow: none;
    }

    .btn-save {
        background-color: #d0011b;
        color: white;
        padding: 10px 30px;
        font-weight: bold;
        border: none;
        transition: 0.3s;
    }

        .btn-save:hover {
            background-color: #b50015;
            color: white;
        }
</style>

<div class="container profile-wrapper">
    <div class="row">
        @* === CỘT TRÁI: MENU ĐIỀU HƯỚNG === *@
        <div class="col-md-3">
            <div class="list-group shadow-sm">
                @* Link về trang thông tin *@
                <a href="@Url.Action("Index", "Profile")" class="list-group-item">
                    <i class="glyphicon glyphicon-user"></i> Thông tin tài khoản
                </a>

                @* Link về lịch sử đơn hàng *@
                <a href="@Url.Action("History", "Order")" class="list-group-item">
                    <i class="glyphicon glyphicon-list-alt"></i> Lịch sử đơn hàng
                </a>

                @* Link đổi mật khẩu (ĐANG ACTIVE) *@
                <a href="@Url.Action("ChangePassword", "Profile")" class="list-group-item active">
                    <i class="glyphicon glyphicon-lock"></i> Đổi mật khẩu
                </a>

                @* Nút đăng xuất *@
                <a href="javascript:document.getElementById('logoutForm').submit()" class="list-group-item list-group-item-danger">
                    <i class="glyphicon glyphicon-log-out"></i> Đăng xuất
                </a>
            </div>
        </div>

        @* === CỘT PHẢI: FORM ĐỔI MẬT KHẨU === *@
        <div class="col-md-9">
            <div class="profile-content">
                <div class="profile-header">
                    <h3><i class="glyphicon glyphicon-edit"></i> Thay đổi mật khẩu</h3>
                </div>
                <div class="profile-body">

                    @* Thông báo thành công *@
                    @if (TempData["Message"] != null)
                    {
                        <div class="alert alert-success alert-dismissible" role="alert">
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            <i class="glyphicon glyphicon-ok-sign"></i> @TempData["Message"]
                        </div>
                    }

                    @using (Html.BeginForm("ChangePassword", "Profile", FormMethod.Post, new { @class = "form-horizontal" }))
                    {
                        @Html.AntiForgeryToken()

                        <div class="form-group">
                            <label class="col-sm-4 control-label">Mật khẩu hiện tại <span class="text-danger">*</span></label>
                            <div class="col-sm-7">
                                @Html.PasswordFor(m => m.OldPassword, new { @class = "form-control", @placeholder = "Nhập mật khẩu cũ để xác thực" })
                                @Html.ValidationMessageFor(m => m.OldPassword, "", new { @class = "text-danger" })
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-4 control-label">Mật khẩu mới <span class="text-danger">*</span></label>
                            <div class="col-sm-7">
                                @Html.PasswordFor(m => m.NewPassword, new { @class = "form-control", @placeholder = "Nhập mật khẩu mới (tối thiểu 6 ký tự)" })
                                @Html.ValidationMessageFor(m => m.NewPassword, "", new { @class = "text-danger" })
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-4 control-label">Xác nhận mật khẩu mới <span class="text-danger">*</span></label>
                            <div class="col-sm-7">
                                @Html.PasswordFor(m => m.ConfirmPassword, new { @class = "form-control", @placeholder = "Nhập lại mật khẩu mới" })
                                @Html.ValidationMessageFor(m => m.ConfirmPassword, "", new { @class = "text-danger" })
                            </div>
                        </div>

                        <div class="form-group" style="margin-top: 30px;">
                            <div class="col-sm-offset-4 col-sm-8">
                                <button type="submit" class="btn btn-save">
                                    <i class="glyphicon glyphicon-floppy-disk"></i> Cập nhật mật khẩu
                                </button>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>

@* Form ẩn để xử lý đăng xuất *@
@using (Html.BeginForm("Logout", "Login", FormMethod.Post, new { id = "logoutForm" }))
{
    @Html.AntiForgeryToken()
}